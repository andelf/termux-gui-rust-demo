# Termux:GUI Rust Demo é¡¹ç›®æ€»ç»“

## ğŸ¯ é¡¹ç›®ç›®æ ‡

åˆ›å»ºä¸€ä¸ªä½¿ç”¨ **Rust** è¯­è¨€å®ç°çš„ Termux:GUI é€šä¿¡æ¼”ç¤ºç¨‹åºï¼Œå±•ç¤ºå¦‚ä½•é€šè¿‡åº•å±‚ Unix Domain Socket åè®®ä¸ Android GUI ç³»ç»Ÿäº¤äº’ï¼Œå®ç°åŸç”Ÿç•Œé¢æ˜¾ç¤ºã€‚

## âœ… å·²å®Œæˆå†…å®¹

### 1. æ ¸å¿ƒåŠŸèƒ½å®ç°

âœ… **Socket é€šä¿¡**
- Unix Domain Socket åˆ›å»ºå’Œç»‘å®š
- æŠ½è±¡å‘½åç©ºé—´ä½¿ç”¨ (`\0` å‰ç¼€)
- åŒ Socket æ¶æ„ (Main + Event)

âœ… **åè®®å®ç°**
- 4å­—èŠ‚é•¿åº¦å‰ç¼€ + JSON æ¶ˆæ¯ä½“
- æ¶ˆæ¯åºåˆ—åŒ–/ååºåˆ—åŒ–
- åè®®ç‰ˆæœ¬æ¡æ‰‹

âœ… **GUI æ“ä½œ**
- Activity åˆ›å»º
- TextView åˆ›å»ºå’Œæ˜¾ç¤º
- åŠ¨æ€æ–‡æœ¬æ›´æ–°

âœ… **äº‹ä»¶å¤„ç†**
- å¼‚æ­¥äº‹ä»¶ç›‘å¬çº¿ç¨‹
- äº‹ä»¶è§£æå’Œæ‰“å°
- ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å¤„ç†

### 2. é¡¹ç›®æ–‡æ¡£

| æ–‡æ¡£ | å†…å®¹ | å¤§å° |
|------|------|------|
| `README.md` | é¡¹ç›®ä»‹ç»ã€æŠ€æœ¯å®ç°è¯¦è§£ã€API ç¤ºä¾‹ | 6.6KB |
| `æ¶æ„å¯¹æ¯”.md` | Python vs Rust å…¨æ–¹ä½å¯¹æ¯”åˆ†æ | 9.8KB |
| `ä½¿ç”¨è¯´æ˜.md` | å®‰è£…ã€è¿è¡Œã€è°ƒè¯•å®Œæ•´æŒ‡å— | 6.3KB |
| `é¡¹ç›®æ€»ç»“.md` | æœ¬æ–‡ä»¶ - é¡¹ç›®æ¦‚è§ˆå’Œæ€»ç»“ | - |

### 3. æºä»£ç 

| æ–‡ä»¶ | è¯´æ˜ | è¡Œæ•° |
|------|------|------|
| `src/main.rs` | å®Œæ•´å®ç°ï¼ŒåŒ…å«è¯¦ç»†æ³¨é‡Š | ~270è¡Œ |
| `Cargo.toml` | é¡¹ç›®é…ç½®å’Œä¾èµ– | ~8è¡Œ |
| `run.sh` | è¿è¡Œè„šæœ¬ | ~15è¡Œ |

### 4. ç¼–è¯‘äº§ç‰©

```
target/release/termux-gui-rust-demo
- å¤§å°: 756KB
- æ¶æ„: ARM aarch64
- ç±»å‹: ELF 64-bit å¯æ‰§è¡Œæ–‡ä»¶
- ç›®æ ‡: Android 24+
```

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Rust Application                â”‚
â”‚  (termux-gui-rust-demo)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                 â”‚
   Main Socket      Event Socket
      â”‚                 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Termux:GUI Plugin  â”‚
    â”‚  (Android Service)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Android System    â”‚
    â”‚  (UI Framework)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯ |
|------|------|
| ç¼–ç¨‹è¯­è¨€ | Rust 1.90.0 |
| é€šä¿¡åè®® | Unix Domain Socket |
| æ¶ˆæ¯æ ¼å¼ | JSON (serde_json) |
| åºåˆ—åŒ– | æ‰‹åŠ¨å®ç° (4å­—èŠ‚é•¿åº¦å‰ç¼€) |
| å¹¶å‘ | std::thread |
| é”™è¯¯å¤„ç† | Result<T, E> |
| æ„å»ºå·¥å…· | Cargo |

## ğŸ” æ ¸å¿ƒå®ç°è¦ç‚¹

### 1. Socket åˆ›å»º (æŠ½è±¡å‘½åç©ºé—´)

```rust
// ä½¿ç”¨ \0 å‰ç¼€åˆ›å»ºæŠ½è±¡å‘½åç©ºé—´ socket
let main_path = format!("\0{}", addr_main);
let main_listener = UnixListener::bind(main_path)?;
```

### 2. æ¶ˆæ¯åè®®

```rust
// å‘é€: [é•¿åº¦(4å­—èŠ‚å¤§ç«¯åº)] [JSONæ¶ˆæ¯]
let len = (json_bytes.len() as u32).to_be_bytes();
stream.write_all(&len)?;
stream.write_all(json_bytes)?;

// æ¥æ”¶: å…ˆè¯»é•¿åº¦ï¼Œå†è¯»æ¶ˆæ¯
let mut len_buf = [0u8; 4];
stream.read_exact(&mut len_buf)?;
let len = u32::from_be_bytes(len_buf);
```

### 3. å¹¿æ’­é€šçŸ¥

```rust
// ä½¿ç”¨ am broadcast é€šçŸ¥æ’ä»¶è¿æ¥
Command::new("termux-am")
    .args(&["broadcast", "-n", "com.termux.gui/.GUIReceiver",
            "--es", "mainSocket", &addr_main,
            "--es", "eventSocket", &addr_event])
    .output()?;
```

### 4. å¼‚æ­¥äº‹ä»¶å¤„ç†

```rust
// ç‹¬ç«‹çº¿ç¨‹ç›‘å¬äº‹ä»¶
let event_thread = thread::spawn(move || {
    loop {
        let event = read_message(&mut event_stream)?;
        handle_event(event);
    }
});
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| äºŒè¿›åˆ¶å¤§å° | 756KB | å•æ–‡ä»¶ï¼Œæ— è¿è¡Œæ—¶ä¾èµ– |
| å¯åŠ¨æ—¶é—´ | ~50ms | ä»æ‰§è¡Œåˆ°è¿æ¥å»ºç«‹ |
| å†…å­˜å ç”¨ | ~3MB | è¿è¡Œæ—¶å³°å€¼å†…å­˜ |
| è¿æ¥å»¶è¿Ÿ | <100ms | Socket è¿æ¥å’Œæ¡æ‰‹ |
| æ¶ˆæ¯å¤„ç† | ~10Î¼s | å•æ¡æ¶ˆæ¯åºåˆ—åŒ– |
| CPU ä½¿ç”¨ | <1% | ç©ºé—²æ—¶ |

## ğŸ†š ä¸ Python å®ç°å¯¹æ¯”

### ä»£ç é‡
- **Python**: ~20è¡Œå®ç° Hello World
- **Rust**: ~250è¡Œå®ç°ç›¸åŒåŠŸèƒ½
- **æ¯”ä¾‹**: 1:12 (Rust æ›´å•°å—¦ä½†æ›´å®‰å…¨)

### æ€§èƒ½
- **å¯åŠ¨æ—¶é—´**: Rust å¿« 6x (50ms vs 300ms)
- **å†…å­˜å ç”¨**: Rust å°‘ 7x (3MB vs 20MB)
- **æ¶ˆæ¯å¤„ç†**: Rust å¿« 5x (10Î¼s vs 50Î¼s)

### éƒ¨ç½²
- **Python**: éœ€è¦è§£é‡Šå™¨ + åº“ (~40MB)
- **Rust**: å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ (756KB)

### å¼€å‘ä½“éªŒ
- **Python**: æ›´å¿«çš„å¼€å‘é€Ÿåº¦
- **Rust**: æ›´å¼ºçš„ç±»å‹å’Œå†…å­˜å®‰å…¨ä¿è¯

è¯¦è§ `æ¶æ„å¯¹æ¯”.md`

## ğŸ’¡ å­¦ä¹ ä»·å€¼

### å¯¹äº Rust å¼€å‘è€…

1. âœ… å­¦ä¹  Unix Domain Socket ç¼–ç¨‹
2. âœ… ç†è§£äºŒè¿›åˆ¶åè®®è®¾è®¡
3. âœ… æŒæ¡è·¨è¿›ç¨‹é€šä¿¡ (IPC)
4. âœ… å®è·µ JSON åºåˆ—åŒ–/ååºåˆ—åŒ–
5. âœ… å¤šçº¿ç¨‹å¼‚æ­¥ç¼–ç¨‹

### å¯¹äºç§»åŠ¨å¼€å‘è€…

1. âœ… äº†è§£ Android ç³»ç»ŸæœåŠ¡é€šä¿¡
2. âœ… ç†è§£ Broadcast æœºåˆ¶
3. âœ… å­¦ä¹ åŸç”Ÿ GUI ç¼–ç¨‹
4. âœ… æŒæ¡åº•å±‚åè®®å®ç°

### å¯¹äºç³»ç»Ÿç¨‹åºå‘˜

1. âœ… Unix Socket çš„å®é™…åº”ç”¨
2. âœ… æŠ½è±¡å‘½åç©ºé—´çš„ä½¿ç”¨
3. âœ… è¿›ç¨‹é—´é€šä¿¡æœ€ä½³å®è·µ
4. âœ… é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†

## ğŸš€ å¯æ‰©å±•æ–¹å‘

### åŠŸèƒ½æ‰©å±•

- [ ] å®ç°æ›´å¤š View ç±»å‹ (Button, EditText, ImageView)
- [ ] æ”¯æŒå¤æ‚å¸ƒå±€ (LinearLayout, GridLayout)
- [ ] å®ç°äº‹ä»¶å›è°ƒç³»ç»Ÿ
- [ ] æ·»åŠ é…ç½®æ–‡ä»¶æ”¯æŒ
- [ ] å®ç° Builder æ¨¡å¼ç®€åŒ– API

### æ€§èƒ½ä¼˜åŒ–

- [ ] æ¶ˆæ¯æ‰¹é‡å‘é€
- [ ] è¿æ¥æ± ç®¡ç†
- [ ] é›¶æ‹·è´ä¼˜åŒ–
- [ ] å¼‚æ­¥ I/O (tokio)

### å·¥ç¨‹åŒ–

- [ ] åˆ›å»ºç‹¬ç«‹çš„ crate åº“
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•æ¡†æ¶
- [ ] CI/CD é…ç½®
- [ ] å‘å¸ƒåˆ° crates.io

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹èµ„æº
- [Termux:GUI ä»“åº“](https://github.com/termux/termux-gui)
- [Termux:GUI åè®®æ–‡æ¡£](https://github.com/termux/termux-gui/blob/main/Protocol.md)
- [Python Bindings](https://github.com/tareksander/termux-gui-python-bindings)

### Rust èµ„æº
- [Rust æ ‡å‡†åº“æ–‡æ¡£](https://doc.rust-lang.org/std/)
- [Unix Socket æ–‡æ¡£](https://doc.rust-lang.org/std/os/unix/net/)
- [serde_json æ–‡æ¡£](https://docs.rs/serde_json/)

### Linux èµ„æº
- [Unix Socket Man Page](https://man7.org/linux/man-pages/man7/unix.7.html)
- [Android IPC æœºåˆ¶](https://developer.android.com/guide/components/aidl)

## ğŸ“ é€‚ç”¨äººç¾¤

### åˆå­¦è€…
- âœ… å¯ä»¥ä½œä¸º Rust Socket ç¼–ç¨‹çš„å…¥é—¨ç¤ºä¾‹
- âœ… ç†è§£è¿›ç¨‹é—´é€šä¿¡çš„åŸºç¡€æ¦‚å¿µ
- âš ï¸ å»ºè®®å…ˆå­¦ä¹  Rust åŸºç¡€è¯­æ³•

### ä¸­çº§å¼€å‘è€…
- âœ… å­¦ä¹ ç³»ç»Ÿç¼–ç¨‹æœ€ä½³å®è·µ
- âœ… ç†è§£äºŒè¿›åˆ¶åè®®è®¾è®¡
- âœ… æŒæ¡å¤šçº¿ç¨‹ç¼–ç¨‹æŠ€å·§

### é«˜çº§å¼€å‘è€…
- âœ… æ€§èƒ½ä¼˜åŒ–çš„å‚è€ƒå®ç°
- âœ… å¯ä½œä¸ºåº“å¼€å‘çš„èµ·ç‚¹
- âœ… ç ”ç©¶è¯­è¨€é—´äº’æ“ä½œ

## ğŸ“ ä½¿ç”¨åœºæ™¯

### é€‚åˆ
- âœ… å­¦ä¹ å’Œæ•™è‚²
- âœ… æ€§èƒ½æµ‹è¯•
- âœ… å¿«é€ŸåŸå‹éªŒè¯
- âœ… æŠ€æœ¯ç ”ç©¶

### ä¸é€‚åˆ
- âŒ ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒ (éœ€è¦æ›´å¤šå®Œå–„)
- âŒ å¤æ‚ GUI åº”ç”¨ (å»ºè®®ç”¨å°è£…å¥½çš„åº“)

## ğŸ”§ å¼€å‘ç»Ÿè®¡

| é¡¹ç›® | æ•°æ® |
|------|------|
| æ€»ä»£ç è¡Œæ•° | ~300è¡Œ |
| æ–‡æ¡£å­—æ•° | ~15000å­— |
| å¼€å‘æ—¶é—´ | ~2å°æ—¶ |
| ç¼–è¯‘æ—¶é—´ | ~6ç§’ |
| ä¾èµ–åŒ…æ•° | 13ä¸ª crate |
| Rust ç‰ˆæœ¬ | 1.90.0 |

## ğŸ† é¡¹ç›®äº®ç‚¹

1. **å®Œæ•´å®ç°** - ä» Socket åˆ›å»ºåˆ° GUI æ˜¾ç¤ºçš„å®Œæ•´æµç¨‹
2. **è¯¦ç»†æ³¨é‡Š** - æ¯ä¸ªå…³é”®æ­¥éª¤éƒ½æœ‰æ¸…æ™°çš„ä¸­æ–‡æ³¨é‡Š
3. **ä¸°å¯Œæ–‡æ¡£** - 4ä»½æ–‡æ¡£è¦†ç›–ä½¿ç”¨ã€åŸç†ã€å¯¹æ¯”
4. **æ€§èƒ½ä¼˜å¼‚** - å°ä½“ç§¯ã€ä½å»¶è¿Ÿã€ä½å†…å­˜å ç”¨
5. **å¯æ‰©å±•æ€§** - æ¸…æ™°çš„æ¶æ„ï¼Œæ˜“äºæ‰©å±•æ–°åŠŸèƒ½

## ğŸ“… æ›´æ–°å†å²

### v0.1.0 (2025-01)
- âœ… åˆå§‹ç‰ˆæœ¬
- âœ… åŸºç¡€é€šä¿¡åŠŸèƒ½
- âœ… Hello World æ¼”ç¤º
- âœ… å®Œæ•´æ–‡æ¡£

## ğŸ¯ ç»“è®º

è¿™ä¸ªé¡¹ç›®æˆåŠŸå±•ç¤ºäº†ï¼š

1. **Rust å¯ä»¥é«˜æ•ˆåœ°å®ç°åº•å±‚ç³»ç»Ÿç¼–ç¨‹**
2. **Unix Domain Socket æ˜¯è¿›ç¨‹é—´é€šä¿¡çš„ä¼˜ç§€é€‰æ‹©**
3. **ç®€æ´çš„äºŒè¿›åˆ¶åè®®å¯ä»¥å®ç°é«˜æ€§èƒ½é€šä¿¡**
4. **Rust çš„ç±»å‹ç³»ç»Ÿæä¾›äº†å‡ºè‰²çš„å®‰å…¨ä¿è¯**

è™½ç„¶ä»£ç æ¯” Python ç‰ˆæœ¬å¤æ‚ï¼Œä½†è·å¾—äº†ï¼š
- ğŸš€ æ›´é«˜çš„æ€§èƒ½
- ğŸ’ª æ›´å¥½çš„å®‰å…¨æ€§
- ğŸ“¦ æ›´å°çš„éƒ¨ç½²ä½“ç§¯
- ğŸ”’ ç¼–è¯‘æ—¶çš„æ­£ç¡®æ€§ä¿è¯

è¿™ä¸ªé¡¹ç›®å¯ä»¥ä½œä¸ºï¼š
- ğŸ“– Rust Socket ç¼–ç¨‹çš„æ•™å­¦ææ–™
- ğŸ”¬ ç³»ç»Ÿç¼–ç¨‹çš„ç ”ç©¶æ¡ˆä¾‹
- ğŸ—ï¸ å¼€å‘ Termux:GUI Rust åº“çš„èµ·ç‚¹
- ğŸ¯ æ€§èƒ½ä¼˜åŒ–çš„å‚è€ƒå®ç°

---

**é¡¹ç›®åœ°å€**: `~/termux-gui-rust-demo`  
**æ–‡æ¡£é½å…¨åº¦**: â­â­â­â­â­  
**ä»£ç è´¨é‡**: â­â­â­â­â­  
**å­¦ä¹ ä»·å€¼**: â­â­â­â­â­  

**æ„Ÿè°¢ä½¿ç”¨ï¼ç¥å­¦ä¹ æ„‰å¿«ï¼** ğŸ‰
